10000 SCREEN1,0:WIDTH32:COLOR15,1,1:KEYOFF:DEFINTA-Z
10001 DEFUSR=&H007E:A=USR(0):CLEAR300,&HD000
10010 REM ===========================
10011 REM Variables Definition
10012 REM ===========================
10013 X1=0:Y1=0   ' EDIT CURSOR
10014 X2=0:Y2=128 ' CHAR SELECT CURSOR
10015 SP=0 ' MODE SELECT
10016 SC=0 ' SELECTED CHARACTER
10017 DIM PT(4,8), PC(4,8) ' PATTERN AND COLOR
10500 GOSUB11100:GOSUB12000:GOSUB10750
10550 ONINTERVAL=15GOSUB10600:INTERVALON
10551 INTERVALON:GOTO10551
10600 REM ===========================
10601 REM MAIN ROUTINE 
10602 REM ===========================
10607 ST=STICK(0)ORSTICK(1)
10608 TR=STRIG(0)ORSTRIG(1)
10609 IFST=0ANDTR=0THEN10643
10610 ' CURSOR MOVE
10611 IFSP=1THEN10625
10612 IFST=3THENX1=X1+8
10613 IFST=7THENX1=X1-8
10614 IFST=5THENY1=Y1+8
10615 IFST=1THENY1=Y1-8
10616 IFX1>120THENX1=120
10617 IFX1<0THENX1=0
10618 IFY1>120THENY1=120
10619 IFY1<0THENY1=0
10620 GOTO10641
10625 IFST=3THENX2=X2+8
10626 IFST=7THENX2=X2-8
10627 IFST=5THENY2=Y2+8
10628 IFST=1THENY2=Y2-8
10629 IFX2>247THENX2=247
10630 IFX2<0THENX2=0
10631 IFY2>184THENY2=184
10632 IFY2<128THENY2=128
10640 ' TRIGGER CHECK
10641 IFTR=0THEN10643
10642 IFSP=0THENSP=1ELSESP=0
10643 GOSUB10750
10644 A$=INKEY$:IFA$="q"ORA$="Q"THEN10999
10645 IFA$="z"ORA$="Z"THENGOSUB10810
10698 RETURN
10699 'GOTO10604 'RETURN10551 
10750 ' DISPLAY SPRITE
10751 IFSP=1THEN10757
10752 VPOKE&H1B00,Y1:VPOKE&H1B01,X1:VPOKE&H1B02,0:VPOKE&H1B03,15
10753 VPOKE&H1B04,Y1:VPOKE&H1B05,X1:VPOKE&H1B06,1:VPOKE&H1B07,7
10754 VPOKE&H1B08,209:VPOKE&H1B09,X2:VPOKE&H1B0A,0:VPOKE&H1B0B,15
10755 VPOKE&H1B0C,209:VPOKE&H1B0D,X2:VPOKE&H1B0E,1:VPOKE&H1B0F,7
10756 GOTO10770
10757 VPOKE&H1B00,209:VPOKE&H1B01,X1:VPOKE&H1B02,0:VPOKE&H1B03,15
10758 VPOKE&H1B04,209:VPOKE&H1B05,X1:VPOKE&H1B06,1:VPOKE&H1B07,7
10759 VPOKE&H1B08,Y2:VPOKE&H1B09,X2:VPOKE&H1B0A,0:VPOKE&H1B0B,15
10760 VPOKE&H1B0C,Y2:VPOKE&H1B0D,X2:VPOKE&H1B0E,1:VPOKE&H1B0F,7
10770 RETURN
10810 ' SELECT
10820 IFSP=1THEN10880
10821 GOTO 10899
10880 ' SELECT A CHARACTER
10881 SX=X2/8:SY=(Y2-128)/8
10882 CC=SY*32+SX
10883 ' READ PATTERN DATAS
10884 FORAI=0TO3:FORAJ=0TO7
10885 PT(AI,AJ)=VPEEK(&H1000+CC*8+AJ):PC(AI,AJ)=VPEEK(&H3000+CC*8+AJ):NEXT
10886 IFAI=1THENCC=CC+30
10887 CC=CC+1
10888 NEXT
10898 GOSUB13000
10899 RETURN
10999 CLS:END
11000 REM ===========================
11001 REM INITIAL EDIT CELL CREATE
11002 REM BLANK CELL=&H80
11003 REM COLOR CELL=&H81-&H8F (COLOR1-15)
11004 REM ===========================
11100 RESTORE19200:LOCATE0,0:PRINT"VRAM INITIALIZE":FORI=0TO2047
11101 CV=VPEEK(I):VPOKE &H800+I,CV:VPOKE &H1000+I,CV
11102 VPOKE &H2000+I,&HF1:VPOKE &H2800+I,&HF1:VPOKE &H3000+I,&HF1
11103 NEXT:LOCATE0,1:PRINT"EDITOR CHARACTER INITIALIZE"
11104 RESTORE19200:READA$
11105 FORI=0TO15:C1=&H80+I
11106 FORJ=0TO7:PV=VAL("&H"+MID$(A$,J*2+1,2)):CV=VAL("&H"+HEX$(I)+"F")
11107 VPOKE C1*8+J,PV
11108 VPOKE &H800+C1*8+J,PV
11109 VPOKE &H2000+C1*8+J,CV
11110 VPOKE &H2800+C1*8+J,CV
11111 NEXT
11112 NEXT:CLS
11113 FORX=0TO15:FORY=0TO15:VPOKE &H1800+Y*32+X,&H80:NEXT:NEXT        
11114 FORI=0TO255:VPOKE&H1A00+I,I:NEXT
11115 RETURN
12000 REM ===========================
12001 REM SPRITE DEFINITION
12002 REM ===========================
12003 RESTORE19100:READA$:READB$
12004 FORI=0TO7
12005 VPOKE &H3800+I,VAL("&H"+MID$(A$,I*2+1,2))
12006 VPOKE &H3808+I,VAL("&H"+MID$(B$,I*2+1,2))
12007 NEXT
12008 RETURN
13000 REM ===========================
13001 REM REDRAW EDIT AREA
13002 REM ===========================
13003 FORIE=0TO3
13004 IFIE=0THENAD=&H1800
13005 IFIE=1THENAD=&H1808
13006 IFIE=2THENAD=&H1900
13007 IFIE=3THENAD=&H1908
13008 FORIY=0TO7:L1$=RIGHT$("00000000"+BIN$(PT(IE,IY)),8):CU$=RIGHT$("0"+HEX$(PC(IE,IY)),2)
13009 FORIX=0TO7
13010 IFMID$(L1$,IX+1,1)="0"THENBT=&H80+VAL("&H"+RIGHT$(CU$,1))
13011 IFMID$(L1$,IX+1,1)="1"THENBT=&H80+VAL("&H"+LEFT$(CU$,1))
13012 VPOKEAD+IY*32+IX,BT
13013 NEXT:NEXT
13014 NEXT
13099 RETURN
18000 CLS:END
19000 REM ===========================
19001 REM DATAS
19002 REM ===========================
19100 DATA "5400440054000000"
19101 DATA "2844004428000000"
19200 DATA "FEFEFEFEFEFEFE00"
